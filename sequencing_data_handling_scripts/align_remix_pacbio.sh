#!/bin/bash

#              script         KW20 reads    start.line   end.line   output.name 
#subset for UP04
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 1 476090 RR722.for.UP04.R1.I1
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 1 476090 RR722.for.UP04.R2.I1
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 476091 952179 RR722.for.UP04.R1.I2
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 476091 952179 RR722.for.UP04.R2.I2
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 952180 1428269 RR722.for.UP04.R1.I3
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 952180 1428269 RR722.for.UP04.R2.I3
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 1428270 1904359 RR722.for.UP04.R1.I4
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 1428270 1904359 RR722.for.UP04.R2.I4

#subset for UP05
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 1 1389364 RR722.for.UP05.R1.I1
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 1 1389364 RR722.for.UP05.R2.I1
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 1389365 2778727 RR722.for.UP05.R1.I2
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 1389365 2778727 RR722.for.UP05.R2.I2
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 2778728 4168091 RR722.for.UP05.R1.I3
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 2778728 4168091 RR722.for.UP05.R2.I3
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 4168092 5557454 RR722.for.UP05.R1.I4
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 4168092 5557454 RR722.for.UP05.R2.I4

#subset for UP06
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 1 625292 RR722.for.UP06.R1.I1
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 1 625292 RR722.for.UP06.R2.I1
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 625293 1250583 RR722.for.UP06.R1.I2
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 625293 1250583 RR722.for.UP06.R2.I2
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 1250584 1875875 RR722.for.UP06.R1.I3
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 1250584 1875875 RR722.for.UP06.R2.I3
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 1875876 2501166 RR722.for.UP06.R1.I4
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 1875876 2501166 RR722.for.UP06.R2.I4


#subset for UP10
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 1 1694132 RR722.for.UP10.R1.I1
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 1 1694132 RR722.for.UP10.R2.I1
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 1694133 3388264 RR722.for.UP10.R1.I2
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 1694133 3388264 RR722.for.UP10.R2.I2
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 3388265 5082396 RR722.for.UP10.R1.I3
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 3388265 5082396 RR722.for.UP10.R2.I3
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 5082397 6776529 RR722.for.UP10.R1.I4
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 5082397 6776529 RR722.for.UP10.R2.I4

#subset for UP11
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 1 563520 RR722.for.UP11.R1.I1
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 1 563520 RR722.for.UP11.R2.I1
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 563521 1127040 RR722.for.UP11.R1.I2
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 563521 1127040 RR722.for.UP11.R2.I2
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 1127041 1690559 RR722.for.UP11.R1.I3
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 1127041 1690559 RR722.for.UP11.R2.I3
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 1690560 2254079 RR722.for.UP11.R1.I4
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 1690560 2254079 RR722.for.UP11.R2.I4

#subset for UP12
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 1 1023912 RR722.for.UP12.R1.I1
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 1 1023912 RR722.for.UP12.R2.I1
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 1023913 2047824 RR722.for.UP12.R1.I2
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 1023913 2047824 RR722.for.UP12.R2.I2
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 2047825 3071735 RR722.for.UP12.R1.I3
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 2047825 3071735 RR722.for.UP12.R2.I3
bash scripts/subset.sh fastqs/RR722.R1.fq.gz 3071736 4095647 RR722.for.UP12.R1.I4
bash scripts/subset.sh fastqs/RR722.R2.fq.gz 3071736 4095647 RR722.for.UP12.R2.I4


#mix contaminants with real reads

cat fastqs/UP14.R1.fq.gz temp/RR722.for.UP04.R1.I1.contaminant.fq.gz > REMIX/REMIX14.UP04.I1.R1.fq.gz
cat fastqs/UP14.R2.fq.gz temp/RR722.for.UP04.R2.I1.contaminant.fq.gz > REMIX/REMIX14.UP04.I1.R2.fq.gz
cat fastqs/UP14.R1.fq.gz temp/RR722.for.UP04.R1.I2.contaminant.fq.gz > REMIX/REMIX14.UP04.I2.R1.fq.gz
cat fastqs/UP14.R2.fq.gz temp/RR722.for.UP04.R2.I2.contaminant.fq.gz > REMIX/REMIX14.UP04.I2.R2.fq.gz
cat fastqs/UP14.R1.fq.gz temp/RR722.for.UP04.R1.I3.contaminant.fq.gz > REMIX/REMIX14.UP04.I3.R1.fq.gz
cat fastqs/UP14.R2.fq.gz temp/RR722.for.UP04.R2.I3.contaminant.fq.gz > REMIX/REMIX14.UP04.I3.R2.fq.gz
cat fastqs/UP14.R1.fq.gz temp/RR722.for.UP04.R1.I4.contaminant.fq.gz > REMIX/REMIX14.UP04.I4.R1.fq.gz
cat fastqs/UP14.R2.fq.gz temp/RR722.for.UP04.R2.I4.contaminant.fq.gz > REMIX/REMIX14.UP04.I4.R2.fq.gz

cat fastqs/UP14.R1.fq.gz temp/RR722.for.UP05.R1.I1.contaminant.fq.gz > REMIX/REMIX14.UP05.I1.R1.fq.gz
cat fastqs/UP14.R2.fq.gz temp/RR722.for.UP05.R2.I1.contaminant.fq.gz > REMIX/REMIX14.UP05.I1.R2.fq.gz
cat fastqs/UP14.R1.fq.gz temp/RR722.for.UP05.R1.I2.contaminant.fq.gz > REMIX/REMIX14.UP05.I2.R1.fq.gz
cat fastqs/UP14.R2.fq.gz temp/RR722.for.UP05.R2.I2.contaminant.fq.gz > REMIX/REMIX14.UP05.I2.R2.fq.gz
cat fastqs/UP14.R1.fq.gz temp/RR722.for.UP05.R1.I3.contaminant.fq.gz > REMIX/REMIX14.UP05.I3.R1.fq.gz
cat fastqs/UP14.R2.fq.gz temp/RR722.for.UP05.R2.I3.contaminant.fq.gz > REMIX/REMIX14.UP05.I3.R2.fq.gz
cat fastqs/UP14.R1.fq.gz temp/RR722.for.UP05.R1.I4.contaminant.fq.gz > REMIX/REMIX14.UP05.I4.R1.fq.gz
cat fastqs/UP14.R2.fq.gz temp/RR722.for.UP05.R2.I4.contaminant.fq.gz > REMIX/REMIX14.UP05.I4.R2.fq.gz

cat fastqs/UP14.R1.fq.gz temp/RR722.for.UP06.R1.I1.contaminant.fq.gz > REMIX/REMIX14.UP06.I1.R1.fq.gz
cat fastqs/UP14.R2.fq.gz temp/RR722.for.UP06.R2.I1.contaminant.fq.gz > REMIX/REMIX14.UP06.I1.R2.fq.gz
cat fastqs/UP14.R1.fq.gz temp/RR722.for.UP06.R1.I2.contaminant.fq.gz > REMIX/REMIX14.UP06.I2.R1.fq.gz
cat fastqs/UP14.R2.fq.gz temp/RR722.for.UP06.R2.I2.contaminant.fq.gz > REMIX/REMIX14.UP06.I2.R2.fq.gz
cat fastqs/UP14.R1.fq.gz temp/RR722.for.UP06.R1.I3.contaminant.fq.gz > REMIX/REMIX14.UP06.I3.R1.fq.gz
cat fastqs/UP14.R2.fq.gz temp/RR722.for.UP06.R2.I3.contaminant.fq.gz > REMIX/REMIX14.UP06.I3.R2.fq.gz
cat fastqs/UP14.R1.fq.gz temp/RR722.for.UP06.R1.I4.contaminant.fq.gz > REMIX/REMIX14.UP06.I4.R1.fq.gz
cat fastqs/UP14.R2.fq.gz temp/RR722.for.UP06.R2.I4.contaminant.fq.gz > REMIX/REMIX14.UP06.I4.R2.fq.gz

cat fastqs/UP16.R1.fq.gz temp/RR722.for.UP10.R1.I1.contaminant.fq.gz > REMIX/REMIX16.UP10.I1.R1.fq.gz
cat fastqs/UP16.R2.fq.gz temp/RR722.for.UP10.R2.I1.contaminant.fq.gz > REMIX/REMIX16.UP10.I1.R2.fq.gz
cat fastqs/UP16.R1.fq.gz temp/RR722.for.UP10.R1.I2.contaminant.fq.gz > REMIX/REMIX16.UP10.I2.R1.fq.gz
cat fastqs/UP16.R2.fq.gz temp/RR722.for.UP10.R2.I2.contaminant.fq.gz > REMIX/REMIX16.UP10.I2.R2.fq.gz
cat fastqs/UP16.R1.fq.gz temp/RR722.for.UP10.R1.I3.contaminant.fq.gz > REMIX/REMIX16.UP10.I3.R1.fq.gz
cat fastqs/UP16.R2.fq.gz temp/RR722.for.UP10.R2.I3.contaminant.fq.gz > REMIX/REMIX16.UP10.I3.R2.fq.gz
cat fastqs/UP16.R1.fq.gz temp/RR722.for.UP10.R1.I4.contaminant.fq.gz > REMIX/REMIX16.UP10.I4.R1.fq.gz
cat fastqs/UP16.R2.fq.gz temp/RR722.for.UP10.R2.I4.contaminant.fq.gz > REMIX/REMIX16.UP10.I4.R2.fq.gz

cat fastqs/UP16.R1.fq.gz temp/RR722.for.UP11.R1.I1.contaminant.fq.gz > REMIX/REMIX16.UP11.I1.R1.fq.gz
cat fastqs/UP16.R2.fq.gz temp/RR722.for.UP11.R2.I1.contaminant.fq.gz > REMIX/REMIX16.UP11.I1.R2.fq.gz
cat fastqs/UP16.R1.fq.gz temp/RR722.for.UP11.R1.I2.contaminant.fq.gz > REMIX/REMIX16.UP11.I2.R1.fq.gz
cat fastqs/UP16.R2.fq.gz temp/RR722.for.UP11.R2.I2.contaminant.fq.gz > REMIX/REMIX16.UP11.I2.R2.fq.gz
cat fastqs/UP16.R1.fq.gz temp/RR722.for.UP11.R1.I3.contaminant.fq.gz > REMIX/REMIX16.UP11.I3.R1.fq.gz
cat fastqs/UP16.R2.fq.gz temp/RR722.for.UP11.R2.I3.contaminant.fq.gz > REMIX/REMIX16.UP11.I3.R2.fq.gz
cat fastqs/UP16.R1.fq.gz temp/RR722.for.UP11.R1.I4.contaminant.fq.gz > REMIX/REMIX16.UP11.I4.R1.fq.gz
cat fastqs/UP16.R2.fq.gz temp/RR722.for.UP11.R2.I4.contaminant.fq.gz > REMIX/REMIX16.UP11.I4.R2.fq.gz

cat fastqs/UP16.R1.fq.gz temp/RR722.for.UP12.R1.I1.contaminant.fq.gz > REMIX/REMIX16.UP12.I1.R1.fq.gz
cat fastqs/UP16.R2.fq.gz temp/RR722.for.UP12.R2.I1.contaminant.fq.gz > REMIX/REMIX16.UP12.I1.R2.fq.gz
cat fastqs/UP16.R1.fq.gz temp/RR722.for.UP12.R1.I2.contaminant.fq.gz > REMIX/REMIX16.UP12.I2.R1.fq.gz
cat fastqs/UP16.R2.fq.gz temp/RR722.for.UP12.R2.I2.contaminant.fq.gz > REMIX/REMIX16.UP12.I2.R2.fq.gz
cat fastqs/UP16.R1.fq.gz temp/RR722.for.UP12.R1.I3.contaminant.fq.gz > REMIX/REMIX16.UP12.I3.R1.fq.gz
cat fastqs/UP16.R2.fq.gz temp/RR722.for.UP12.R2.I3.contaminant.fq.gz > REMIX/REMIX16.UP12.I3.R2.fq.gz
cat fastqs/UP16.R1.fq.gz temp/RR722.for.UP12.R1.I4.contaminant.fq.gz > REMIX/REMIX16.UP12.I4.R1.fq.gz
cat fastqs/UP16.R2.fq.gz temp/RR722.for.UP12.R2.I4.contaminant.fq.gz > REMIX/REMIX16.UP12.I4.R2.fq.gz

#align sequences to NP or GG genomes using BWA 
#          script                sample name       reference to use
bash scripts/alignerUptake3.sh REMIX14.UP04.I1 pilonrefs/gg.pilon.fna
bash scripts/alignerUptake3.sh REMIX14.UP04.I2 pilonrefs/gg.pilon.fna
bash scripts/alignerUptake3.sh REMIX14.UP04.I3 pilonrefs/gg.pilon.fna
bash scripts/alignerUptake3.sh REMIX14.UP04.I4 pilonrefs/gg.pilon.fna

bash scripts/alignerUptake3.sh REMIX14.UP05.I1 pilonrefs/gg.pilon.fna
bash scripts/alignerUptake3.sh REMIX14.UP05.I2 pilonrefs/gg.pilon.fna
bash scripts/alignerUptake3.sh REMIX14.UP05.I3 pilonrefs/gg.pilon.fna
bash scripts/alignerUptake3.sh REMIX14.UP05.I4 pilonrefs/gg.pilon.fna

bash scripts/alignerUptake3.sh REMIX14.UP06.I1 pilonrefs/gg.pilon.fna
bash scripts/alignerUptake3.sh REMIX14.UP06.I2 pilonrefs/gg.pilon.fna
bash scripts/alignerUptake3.sh REMIX14.UP06.I3 pilonrefs/gg.pilon.fna
bash scripts/alignerUptake3.sh REMIX14.UP06.I4 pilonrefs/gg.pilon.fna

bash scripts/alignerUptake3.sh REMIX16.UP10.I1 pilonrefs/gg.pilon.fna
bash scripts/alignerUptake3.sh REMIX16.UP10.I2 pilonrefs/gg.pilon.fna
bash scripts/alignerUptake3.sh REMIX16.UP10.I3 pilonrefs/gg.pilon.fna
bash scripts/alignerUptake3.sh REMIX16.UP10.I4 pilonrefs/gg.pilon.fna

bash scripts/alignerUptake3.sh REMIX16.UP11.I1 pilonrefs/gg.pilon.fna
bash scripts/alignerUptake3.sh REMIX16.UP11.I2 pilonrefs/gg.pilon.fna
bash scripts/alignerUptake3.sh REMIX16.UP11.I3 pilonrefs/gg.pilon.fna
bash scripts/alignerUptake3.sh REMIX16.UP11.I4 pilonrefs/gg.pilon.fna

bash scripts/alignerUptake3.sh REMIX16.UP12.I1 pilonrefs/gg.pilon.fna
bash scripts/alignerUptake3.sh REMIX16.UP12.I2 pilonrefs/gg.pilon.fna
bash scripts/alignerUptake3.sh REMIX16.UP12.I3 pilonrefs/gg.pilon.fna
bash scripts/alignerUptake3.sh REMIX16.UP12.I4 pilonrefs/gg.pilon.fna

# mark duplicates and convert from sam files to bam files
#         script             input.name        reference      input.folder  output.folder

bash scripts/alignrest.sh REMIX14.UP04.I1 pilonrefs/gg.pilon.fna REMIX up_bams
bash scripts/alignrest.sh REMIX14.UP04.I2 pilonrefs/gg.pilon.fna REMIX up_bams
bash scripts/alignrest.sh REMIX14.UP04.I3 pilonrefs/gg.pilon.fna REMIX up_bams
bash scripts/alignrest.sh REMIX14.UP04.I4 pilonrefs/gg.pilon.fna REMIX up_bams

bash scripts/alignrest.sh REMIX14.UP05.I1 pilonrefs/gg.pilon.fna REMIX up_bams
bash scripts/alignrest.sh REMIX14.UP05.I2 pilonrefs/gg.pilon.fna REMIX up_bams
bash scripts/alignrest.sh REMIX14.UP05.I3 pilonrefs/gg.pilon.fna REMIX up_bams
bash scripts/alignrest.sh REMIX14.UP05.I4 pilonrefs/gg.pilon.fna REMIX up_bams

bash scripts/alignrest.sh REMIX14.UP06.I1 pilonrefs/gg.pilon.fna REMIX up_bams
bash scripts/alignrest.sh REMIX14.UP06.I2 pilonrefs/gg.pilon.fna REMIX up_bams
bash scripts/alignrest.sh REMIX14.UP06.I3 pilonrefs/gg.pilon.fna REMIX up_bams
bash scripts/alignrest.sh REMIX14.UP06.I4 pilonrefs/gg.pilon.fna REMIX up_bams

bash scripts/alignrest.sh REMIX16.UP10.I1 pilonrefs/gg.pilon.fna REMIX up_bams
bash scripts/alignrest.sh REMIX16.UP10.I2 pilonrefs/gg.pilon.fna REMIX up_bams
bash scripts/alignrest.sh REMIX16.UP10.I3 pilonrefs/gg.pilon.fna REMIX up_bams
bash scripts/alignrest.sh REMIX16.UP10.I4 pilonrefs/gg.pilon.fna REMIX up_bams

bash scripts/alignrest.sh REMIX16.UP11.I1 pilonrefs/gg.pilon.fna REMIX up_bams
bash scripts/alignrest.sh REMIX16.UP11.I2 pilonrefs/gg.pilon.fna REMIX up_bams
bash scripts/alignrest.sh REMIX16.UP11.I3 pilonrefs/gg.pilon.fna REMIX up_bams
bash scripts/alignrest.sh REMIX16.UP11.I4 pilonrefs/gg.pilon.fna REMIX up_bams

bash scripts/alignrest.sh REMIX16.UP12.I1 pilonrefs/gg.pilon.fna REMIX up_bams
bash scripts/alignrest.sh REMIX16.UP12.I2 pilonrefs/gg.pilon.fna REMIX up_bams
bash scripts/alignrest.sh REMIX16.UP12.I3 pilonrefs/gg.pilon.fna REMIX up_bams
bash scripts/alignrest.sh REMIX16.UP12.I4 pilonrefs/gg.pilon.fna REMIX up_bams

# Calculate coverage and build bed files
bash scripts/coverage3.sh

