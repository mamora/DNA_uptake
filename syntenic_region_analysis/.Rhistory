source("~/DNA_uptake/helper_functions/pssmFunctions1.R")
source("~/DNA_uptake/helper_functions/functions_syntenic.R")
source("~/DNA_uptake/helper_functions/functions_syntenic.R")
knitr::opts_knit$set(root.dir = '~/DNA_uptake')
np.block    <- "~/DNA_uptake/DNA_uptake/syntenic_region_analysis/pilon_mauve/NP.col.fasta" # colinear fasta to the NP genome
PittGG.block    <- "~/DNA_uptake/DNA_uptake/syntenic_region_analysis/pilon_mauve/PittGG.col.fasta" # colinear fasta to the PittGG genome
colinear.np <- read.genome(np.block) # read fasta with seqinr, then massage
np.block    <- "~/DNA_uptake/syntenic_region_analysis/pilon_mauve/NP.col.fasta" # colinear fasta to the NP genome
PittGG.block    <- "~/DNA_uptake/DNA_uptake/syntenic_region_analysis/pilon_mauve/PittGG.col.fasta" # colinear fasta to the PittGG genome
PittGG.block    <- "~/DNA_uptake/syntenic_region_analysis/pilon_mauve/PittGG.col.fasta" # colinear fasta to the PittGG genome
colinear.PittGG <- read.genome(PittGG.block) # read fasta with seqinr, then massage
np.block    <- "~/DNA_uptake/syntenic_region_analysis/pilon_mauve/NP_col.fasta" # colinear fasta to the NP genome
PittGG.block    <- "~/DNA_uptake/syntenic_region_analysis/pilon_mauve/PittGG_col.fasta" # colinear fasta to the PittGG genome
colinear.np <- read.genome(np.block) # read fasta with seqinr, then massage
colinear.PittGG <- read.genome(PittGG.block) # read fasta with seqinr, then massage
length(colinear.np[[1]]) - length(colinear.PittGG[[1]]) # checking that the sequences are properly aligned --> result must be 0
left<- read.delim("./left.txt", header = FALSE)[,1]
left
# Set the path of the working directory;
knitr::opts_knit$set(root.dir = '~/DNA_uptake')
left<- read.delim("~/DNA_uptake/syntenic_region_analysis/pilon_mauve/left.txt", header = FALSE)[,1]
str(left)
right<- read.delim("~/DNA_uptake/syntenic_region_analysis/pilon_mauve/right.txt", header = FALSE)[,1]
str(right)
# Set the path of the working directory;
knitr::opts_knit$set(root.dir = '~/DNA_uptake')
samples<- read.delim("~/DNA_uptake/syntenic_region_analysis/pilon_mauve/names.txt", header = FALSE)
str(samples)
samples
samples
str(samples)
str(right)
block1<- data.frame(samples = samples, left = left, right = right)
block1$right[2] - block1$left[2]
# Set the path of the working directory;
knitr::opts_knit$set(root.dir = '~/DNA_uptake')
block1$right[1] - block1$left[1]
block1$right[1] - block1$left[1]
# Set the path of the working directory;
knitr::opts_knit$set(root.dir = '~/DNA_uptake')
m<- synthetic(block = block1,colinear.PittGG, colinear.np)
rownames(m) <-first.row
first.row<- c("NP_sequence", "PittGG_sequence", "NP_positions", "PittGG_positions")
rownames(m) <-first.row
View(m[1:4,1:20])
block.d<- syn_to_data(m)
str(block.d)
library(ggplot2)
library(dplyr)
library(data.table)
library(scales)
library(ggplot2)
library(dplyr)
library(data.table)
library(scales)
Uptake.ratio.gg<- fread("~/DNA_uptake/datasets/tables/Uptake.ratio.gg.csv") #load new input samples fro UP01
Uptake.ratio.np<- fread("~/DNA_uptake/datasets/tables/Uptake.ratio.np.csv") #load new input samples fro UP01
source("~/DNA_uptake/helper_functions/functions_syntenic.R")
np.block    <- "~/DNA_uptake/syntenic_region_analysis/pilon_mauve/NP_col.fasta" # colinear fasta to the NP genome
PittGG.block    <- "~/DNA_uptake/syntenic_region_analysis/pilon_mauve/PittGG_col.fasta" # colinear fasta to the PittGG genome
# Read in genome
colinear.np <- read.genome(np.block) # read fasta with seqinr, then massage
source("~/DNA_uptake/helper_functions/pssmFunctions1.R")
np.block    <- "~/DNA_uptake/syntenic_region_analysis/pilon_mauve/NP_col.fasta" # colinear fasta to the NP genome
PittGG.block    <- "~/DNA_uptake/syntenic_region_analysis/pilon_mauve/PittGG_col.fasta" # colinear fasta to the PittGG genome
# Read in genome
colinear.np <- read.genome(np.block) # read fasta with seqinr, then massage
# Read in genome
colinear.PittGG <- read.genome(PittGG.block) # read fasta with seqinr, then massage
length(colinear.np[[1]]) - length(colinear.PittGG[[1]]) # checking that the sequences are properly aligned --> result must be 0
left<- read.delim("~/DNA_uptake/syntenic_region_analysis/pilon_mauve/left.txt", header = FALSE)[,1]
str(left)
#get the end sequence position of the aligned sequences
right<- read.delim("~/DNA_uptake/syntenic_region_analysis/pilon_mauve/right.txt", header = FALSE)[,1]
str(right)
# get the strain names
samples<- read.delim("~/DNA_uptake/syntenic_region_analysis/pilon_mauve/names.txt", header = FALSE)
str(samples)
block1<- data.frame(samples = samples, left = left, right = right)
# Set the path of the working directory;
knitr::opts_knit$set(root.dir = '~/DNA_uptake')
m<- synthetic(block = block1, colinear.PittGG, colinear.np)
first.row<- c("NP_sequence", "PittGG_sequence", "NP_positions", "PittGG_positions")
rownames(m) <-first.row
View(m[1:4,1:20])
block1
block$left[1]
block1$left[1]
synthetic<- function(block, PittGG.block, np.block){
#find positions with "n" and without "n"
gaps<- which(np.block[[1]] == "-")
nongaps<- which(np.block[[1]] != "-")
#get size of the colinear block
np.block.size<- length(np.block[[1]])
pos <- np.block #renamed
p<- c(block$left[2]:block$right[2]) # make a vector with genomic positions of the block
positions.np<- c(1:length(pos[[1]])) #make a vector of the same size as the block
positions.np[nongaps]<- p # fill the position vector with genomic positions for positions without gaps
g<- rep(0,length(gaps))  # create a vector of gaps of value 0
positions.np[gaps]<- g  # fill the positions with value of 0 for gaps
############################################################
####################Do the same for PittGG##################
############################################################
#find positions with "n"
gaps<- which(PittGG.block [[1]] == "-")
nongaps<- which(PittGG.block [[1]] != "-")
GG.block.size<- length(PittGG.block [[1]])
pos <- PittGG.block
p<- c(block$left[1]:block$right[1]) # make a vector with genomic positions of the block
positions.GG<- c(1:length(pos[[1]])) # make a vector of the same size as the block
positions.GG[nongaps]<- p #fill the position vector with genomic positions for positions without gaps
g<- rep(0,length(gaps))  # create a vector of gaps of value 0
positions.GG[gaps]<- g  ## fill the positions with value of 0 for gaps
###########################################################
#################create matrix#############################
###########################################################
m<- matrix(data = NA, nrow = 4, ncol = length(PittGG.block[[1]]))
m[1,]<- np.block[[1]]
m[2,]<- PittGG.block[[1]]
m[3,]<- positions.np
m[4,]<- positions.GG
return(m)
}
m<- synthetic(block = block1, colinear.PittGG, colinear.np)
first.row<- c("NP_sequence", "PittGG_sequence", "NP_positions", "PittGG_positions")
rownames(m) <-first.row
View(m[1:4,1:20])
block.d<- syn_to_data(m)
str(block.d)
# Set the path of the working directory;
knitr::opts_knit$set(root.dir = '~/DNA_uptake')
dim(m)
# Set the path of the working directory;
knitr::opts_knit$set(root.dir = '~/DNA_uptake')
View(m[1:4,1:20])
m3.up<- Uptake.ratio.np[m[3,1]:m[3,20001],]
# Set the path of the working directory;
knitr::opts_knit$set(root.dir = '~/DNA_uptake')
m3.up<- Uptake.ratio.np[m[3,1]:m[3,20000],]
str(m3.up)
# Set the path of the working directory;
knitr::opts_knit$set(root.dir = '~/DNA_uptake')
m3.up.np<- Uptake.ratio.np[m[3,1]:m[3,20000],]
m3.up.gg<- Uptake.ratio.gg[m[4,1]:m[4,20000],]
# Set the path of the working directory;
knitr::opts_knit$set(root.dir = '~/DNA_uptake')
theme_set(theme_grey()) #set theme
whereami <- "C:/Users/marcelo/Dropbox/uptake/Uptake_summer2017/Figures/Uptake_maps/"
# Set directory
setwd(whereami)
p <- ggplot() +
geom_point(aes(x = pos, y = ratio_short), colour = "blue", data = m3.up.np, shape = 20, size = 1) +
geom_point(aes(x = pos, y = ratio_short), colour = "red", data = m3.up.gg, shape = 20, size = 1) +
scale_y_continuous(limits = c(0, 15), expand = c(0, 0))+
scale_x_continuous(expand = c(0, 0))+
labs(x = "genome positions", y = "uptake ratio per position") +
ggtitle(" uptake genomic map of mean uptake ratios from NP (blue) and PittGG (red) small fragment donor DNA") +
theme() +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = rel(1.2), face = "bold", vjust = 1.5))
# Set the path of the working directory;
knitr::opts_knit$set(root.dir = '~/DNA_uptake')
file_name = paste("short.ratio.syntenic","20kb", "tiff", sep=".")
tiff(file_name, width = 800, height = 500, units = "px")
print(u)
# Set the path of the working directory;
knitr::opts_knit$set(root.dir = '~/DNA_uptake')
p <- ggplot() +
geom_point(aes(x = pos, y = ratio_short), colour = "blue", data = m3.up.np, shape = 20, size = 1) +
geom_point(aes(x = pos, y = ratio_short), colour = "red", data = m3.up.gg, shape = 20, size = 1) +
scale_y_continuous(limits = c(0, 15), expand = c(0, 0))+
scale_x_continuous(breaks = seq(0 , 20000, 2000), expand = c(0, 0))+
labs(x = "genome positions", y = "uptake ratio per position") +
ggtitle(" uptake genomic map of mean uptake ratios from NP (blue) and PittGG (red) small fragment donor DNA") +
theme() +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = rel(1.2), face = "bold", vjust = 1.5))
file_name = paste("short.ratio.syntenic","20kb", "tiff", sep=".")
tiff(file_name, width = 800, height = 500, units = "px")
print(p)
dev.off()
whereami <- "C:/Users/marcelo/Dropbox/uptake/Uptake_summer2017/Figures/Uptake_maps/"
setwd(whereami)
p <- ggplot() +
geom_point(aes(x = pos, y = ratio_short), colour = "blue", data = m3.up.np, shape = 20, size = 1) +
geom_point(aes(x = pos, y = ratio_short), colour = "red", data = m3.up.gg, shape = 20, size = 1) +
scale_y_continuous(limits = c(0, 15), expand = c(0, 0))+
scale_x_continuous(breaks = seq(0 , 20000, 2000), expand = c(0, 0))+
labs(x = "genome positions", y = "uptake ratio per position") +
ggtitle(" uptake genomic map of mean uptake ratios from NP (blue) and PittGG (red) small fragment donor DNA") +
theme() +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = rel(1.2), face = "bold", vjust = 1.5))
file_name = paste("short.ratio.syntenic","20kb", "tiff", sep=".")
tiff(file_name, width = 800, height = 500, units = "px")
print(p)
dev.off()
p
# Set the path of the working directory;
knitr::opts_knit$set(root.dir = '~/DNA_uptake')
p <- ggplot() +
geom_point(aes(x = pos, y = ratio_short), colour = "blue", data = m3.up.np, shape = 20, size = 1) +
geom_point(aes(x = pos, y = ratio_short), colour = "red", data = m3.up.gg, shape = 20, size = 1) +
scale_y_continuous(limits = c(0, 15), expand = c(0, 0))+
scale_x_continuous(breaks = seq(0 , 20000, 2000), expand = c(0, 0))+
labs(x = "genome positions", y = "uptake ratio per position") +
ggtitle(" uptake genomic map of mean uptake ratios from NP (blue) and PittGG (red) small fragment donor DNA") +
theme() +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = rel(1.2), face = "bold", vjust = 1.5))
file_name = paste("C:/Users/marcelo/Dropbox/uptake/Uptake_summer2017/Figures/short.ratio.syntenic","20kb", "tiff", sep=".")
tiff(file_name, width = 800, height = 500, units = "px")
print(p)
dev.off()
# Set the path of the working directory;
knitr::opts_knit$set(root.dir = '~/DNA_uptake')
p <- ggplot() +
geom_point(aes(x = pos, y = ratio_short), colour = "blue", data = m3.up.np, shape = 20, size = 1) +
scale_y_continuous(limits = c(0, 15), expand = c(0, 0))+
scale_x_continuous(breaks = seq(0 , 20000, 2000), expand = c(0, 0))+
labs(x = "genome positions", y = "uptake ratio per position") +
ggtitle(" uptake genomic map of mean uptake ratios from NP (blue) and PittGG (red) small fragment donor DNA") +
theme() +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = rel(1.2), face = "bold", vjust = 1.5))
file_name = paste("C:/Users/marcelo/Dropbox/uptake/Uptake_summer2017/Figures/Uptake_maps/short.ratio.np.syntenic","20kb", "tiff", sep=".")
tiff(file_name, width = 800, height = 500, units = "px")
print(p)
dev.off()
# Set the path of the working directory;
knitr::opts_knit$set(root.dir = '~/DNA_uptake')
p <- ggplot() +
geom_point(aes(x = pos, y = ratio_short), colour = "blue", data = m3.up.gg, shape = 20, size = 1) +
scale_y_continuous(limits = c(0, 15), expand = c(0, 0))+
scale_x_continuous(breaks = seq(0 , 20000, 2000), expand = c(0, 0))+
labs(x = "genome positions", y = "uptake ratio per position") +
ggtitle(" uptake genomic map of mean uptake ratios from NP (blue) and PittGG (red) small fragment donor DNA") +
theme() +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = rel(1.2), face = "bold", vjust = 1.5))
file_name = paste("C:/Users/marcelo/Dropbox/uptake/Uptake_summer2017/Figures/Uptake_maps/short.ratio.gg.syntenic","20kb", "tiff", sep=".")
tiff(file_name, width = 800, height = 500, units = "px")
print(p)
dev.off()
# Set the path of the working directory;
knitr::opts_knit$set(root.dir = '~/DNA_uptake')
p <- ggplot() +
geom_point(aes(x = pos, y = ratio_short), colour = "blue", data = m3.up.np, shape = 20, size = 1) +
scale_y_continuous(limits = c(0, 15), expand = c(0, 0))+
scale_x_continuous(expand = c(0, 0))+
labs(x = "genome positions", y = "uptake ratio per position") +
ggtitle(" uptake genomic map of mean uptake ratios from NP small fragment donor DNA") +
theme() +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = rel(1.2), face = "bold", vjust = 1.5))
file_name = paste("C:/Users/marcelo/Dropbox/uptake/Uptake_summer2017/Figures/Uptake_maps/short.ratio.np.syntenic","20kb", "tiff", sep=".")
tiff(file_name, width = 800, height = 500, units = "px")
print(p)
dev.off()
p <- ggplot() +
geom_point(aes(x = pos, y = ratio_short), colour = "blue", data = m3.up.gg, shape = 20, size = 1) +
scale_y_continuous(limits = c(0, 15), expand = c(0, 0))+
scale_x_continuous(expand = c(0, 0))+
labs(x = "genome positions", y = "uptake ratio per position") +
ggtitle(" uptake genomic map of mean uptake ratios from PittGG small fragment donor DNA") +
theme() +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = rel(1.2), face = "bold", vjust = 1.5))
file_name = paste("C:/Users/marcelo/Dropbox/uptake/Uptake_summer2017/Figures/Uptake_maps/short.ratio.gg.syntenic","20kb", "tiff", sep=".")
tiff(file_name, width = 800, height = 500, units = "px")
print(p)
dev.off()
theme_set(theme_grey()) #set theme
# Set the path of the working directory;
knitr::opts_knit$set(root.dir = '~/DNA_uptake')
p <- ggplot() +
geom_point(aes(x = pos, y = ratio_short), colour = "blue", data = m3.up.np, shape = 20, size = 1) +
scale_y_continuous(limits = c(0, 15), expand = c(0, 0))+
scale_x_continuous(expand = c(0, 0))+
labs(x = "genome positions", y = "uptake ratio per position") +
ggtitle(" uptake genomic map of mean uptake ratios from NP small fragment donor DNA") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = rel(1.2), face = "bold", vjust = 1.5))
file_name = paste("C:/Users/marcelo/Dropbox/uptake/Uptake_summer2017/Figures/Uptake_maps/short.ratio.np.syntenic","20kb", "tiff", sep=".")
tiff(file_name, width = 800, height = 500, units = "px")
print(p)
dev.off()
p <- ggplot() +
geom_point(aes(x = pos, y = ratio_short), colour = "blue", data = m3.up.gg, shape = 20, size = 1) +
scale_y_continuous(limits = c(0, 15), expand = c(0, 0))+
scale_x_continuous(expand = c(0, 0))+
labs(x = "genome positions", y = "uptake ratio per position") +
ggtitle(" uptake genomic map of mean uptake ratios from PittGG small fragment donor DNA") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = rel(1.2), face = "bold", vjust = 1.5))
file_name = paste("C:/Users/marcelo/Dropbox/uptake/Uptake_summer2017/Figures/Uptake_maps/short.ratio.gg.syntenic","20kb", "tiff", sep=".")
tiff(file_name, width = 800, height = 500, units = "px")
print(p)
dev.off()
# Set the path of the working directory;
knitr::opts_knit$set(root.dir = '~/DNA_uptake')
p <- ggplot() +
geom_point(aes(x = pos, y = ratio_short), colour = "blue", data = m3.up.np, shape = 20, size = 1) +
scale_y_continuous(limits = c(0, 15), expand = c(0, 0))+
scale_x_continuous(expand = c(0, 0))+
labs(x = "genome positions", y = "uptake ratio per position") +
ggtitle(" uptake genomic map of mean uptake ratios from NP small fragment donor DNA") +
theme(plot.margin=unit(c(1,1,1,1),"cm"),
legend.position = "bottom",
panel.grid.minor = element_line(colour="white", size=0.5),
plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
axis.text  = element_text(size=18),
axis.title = element_text(size = 18, face = "bold"))
file_name = paste("C:/Users/marcelo/Dropbox/uptake/Uptake_summer2017/Figures/Uptake_maps/short.ratio.np.syntenic","20kb", "tiff", sep=".")
tiff(file_name, width = 800, height = 500, units = "px")
print(p)
dev.off()
p <- ggplot() +
geom_point(aes(x = pos, y = ratio_short), colour = "blue", data = m3.up.gg, shape = 20, size = 1) +
scale_y_continuous(limits = c(0, 15), expand = c(0, 0))+
scale_x_continuous(expand = c(0, 0))+
labs(x = "genome positions", y = "uptake ratio per position") +
ggtitle(" uptake genomic map of mean uptake ratios from PittGG small fragment donor DNA") +
theme(plot.margin=unit(c(1,1,1,1),"cm"),
legend.position = "bottom",
panel.grid.minor = element_line(colour="white", size=0.5),
plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
axis.text  = element_text(size=18),
axis.title = element_text(size = 18, face = "bold"))
file_name = paste("C:/Users/marcelo/Dropbox/uptake/Uptake_summer2017/Figures/Uptake_maps/short.ratio.gg.syntenic","20kb", "tiff", sep=".")
tiff(file_name, width = 800, height = 500, units = "px")
print(p)
dev.off()
